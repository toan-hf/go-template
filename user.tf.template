{{$user := yaml "./user.yaml" -}}

# DO NOT EDIT THIS FILE DIRECTLY
## EDIT ./user.yaml 
## RUN make user.tf 

{{ range $roles, $members_list := $user.roles }}
data "datadog_role" "{{ $roles }}" {
  filter = "Datadog {{ $roles }} Role"
}

{{- range $members := $members_list.members }}
resource "datadog_user" "{{ $roles }}" {
   email = "{{ $members }}"
   name  = "{{ index $members }}"
   roles = [data.datadog_role.{{ $roles }}.id]
}
{{- end }}

{{- end }}
